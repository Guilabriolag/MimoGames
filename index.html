<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ZYRO Mobile Prototype</title>
<style>
  html, body {margin:0; padding:0; overflow:hidden; height:100%; width:100%; background:#222;}
  canvas {display:block; background:#4caf50;}
  #hud {position:absolute; top:10px; left:10px; color:white; font:bold 18px Arial; background:rgba(0,0,0,0.5); padding:5px 10px; border-radius:8px;}
  #joystick {position:absolute; bottom:80px; left:80px; width:140px; height:140px; background:rgba(255,255,255,0.2); border-radius:50%; touch-action:none;}
  #stick {position:absolute; left:50%; top:50%; width:60px; height:60px; background:rgba(255,255,255,0.7); border-radius:50%; transform:translate(-50%,-50%);}
  #buttons {position:absolute; bottom:80px; right:20px; display:flex; flex-direction:column; gap:10px;}
  .btn {width:60px; height:60px; border-radius:50%; font-weight:bold; font-size:20px; color:white; display:flex; justify-content:center; align-items:center; touch-action:none;}
  #btnA{background:red;} #btnB{background:blue;} #btnC{background:green;} #btnD{background:orange;}
  #inventory {position:absolute; top:50px; right:10px; background:rgba(0,0,0,0.7); color:white; padding:10px; border-radius:8px; display:none;}
</style>
</head>
<body>
<canvas id="game"></canvas>
<div id="hud">√Årea: Residencial</div>
<div id="joystick"><div id="stick"></div></div>
<div id="buttons">
  <div class="btn" id="btnA">A</div>
  <div class="btn" id="btnB">B</div>
  <div class="btn" id="btnC">C</div>
  <div class="btn" id="btnD">D</div>
</div>
<div id="inventory">Invent√°rio:<br><span id="invList"></span></div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// ----- Player -----
let player = {
  x:300, y:300, r:20, speed:5,
  inventory:[], maxInventory:10, equipped:null,
  blockX:4, blockY:1 // Residencial inicial
};

// ----- HUD -----
const hud = document.getElementById("hud");
const inventoryDiv = document.getElementById("inventory");
const invList = document.getElementById("invList");
function updateHUD(){
  hud.textContent = "√Årea: " + mapGrid[player.blockY][player.blockX].name;
  invList.textContent = player.inventory.join(", ");
}

// ----- Grid do mapa -----
const mapGrid = [
  [{name:"Floresta"},{name:"Floresta"},{name:"Floresta"},{name:"Floresta"},{name:"Floresta"},{name:"Floresta"}],
  [{name:"Floresta"},{name:"Industrial"},{name:"Rodovia"},{name:"Comercial"},{name:"Residencial"},{name:"Floresta"}],
  [{name:"Floresta"},{name:"Estrada"},{name:"Parque"},{name:"Avenida"},{name:"Avenida"},{name:"Floresta"}],
  [{name:"Floresta"},{name:"Comercial"},{name:"Centro"},{name:"Centro"},{name:"Residencial"},{name:"Floresta"}],
  [{name:"Floresta"},{name:"Rua"},{name:"Centro"},{name:"Centro"},{name:"Residencial"},{name:"Floresta"}],
  [{name:"Floresta"},{name:"Parque"},{name:"Comercial"},{name:"Comercial"},{name:"Residencial"},{name:"Floresta"}],
  [{name:"Floresta"},{name:"Floresta"},{name:"Floresta"},{name:"Floresta"},{name:"Floresta"},{name:"Floresta"}]
];
const blockSize = 1000;

// ----- Caixas e arm√°rios -----
let boxes = [{x:350,y:350,items:["üéí","ü•§","üç´","üî™","üîë"]}];
let lockers = [{x:500,y:400,items:[]}] // 100 slots

// ----- Itens no ch√£o -----
let groundItems = [];

// ----- Joystick -----
const joystick = document.getElementById("joystick");
const stick = document.getElementById("stick");
let joy={active:false,x:0,y:0};
joystick.addEventListener("touchstart", e=>{ e.preventDefault(); joy.active=true; });
joystick.addEventListener("touchend", e=>{ e.preventDefault(); joy.active=false; stick.style.left="50%"; stick.style.top="50%"; joy.x=0; joy.y=0; });
joystick.addEventListener("touchmove", e=>{
  e.preventDefault();
  if(!joy.active) return;
  const rect = joystick.getBoundingClientRect();
  const touch = e.touches[0];
  let dx = touch.clientX-(rect.left+rect.width/2);
  let dy = touch.clientY-(rect.top+rect.height/2);
  const dist = Math.min(Math.sqrt(dx*dx+dy*dy), rect.width/2);
  const angle = Math.atan2(dy,dx);
  stick.style.left=rect.width/2+dist*Math.cos(angle)+"px";
  stick.style.top=rect.height/2+dist*Math.sin(angle)+"px";
  joy.x=Math.cos(angle)*(dist/(rect.width/2));
  joy.y=Math.sin(angle)*(dist/(rect.width/2));
});

// ----- Bot√µes -----
document.getElementById("btnB").addEventListener("touchstart",()=>{ inventoryDiv.style.display = inventoryDiv.style.display==='none' ? 'block':'none'; });
document.getElementById("btnA").addEventListener("touchstart",()=>{
  // Checa proximidade de caixas
  boxes.forEach(box=>{
    if(Math.abs(player.x-box.x)<50 && Math.abs(player.y-box.y)<50){
      // Abrir caixa e pegar item
      if(box.items.length>0 && player.inventory.length<player.maxInventory){
        player.inventory.push(box.items.pop());
        updateHUD();
      }
    }
  });
});

// ----- Loop de jogo -----
function loop(){
  player.x += joy.x*player.speed;
  player.y += joy.y*player.speed;

  // Troca de tela
  if(player.x<0 && player.blockX>0){player.blockX--;player.x=canvas.width/2;}
  if(player.x>canvas.width && player.blockX<mapGrid[0].length-1){player.blockX++;player.x=canvas.width/2;}
  if(player.y<0 && player.blockY>0){player.blockY--;player.y=canvas.height/2;}
  if(player.y>canvas.height && player.blockY<mapGrid.length-1){player.blockY++;player.y=canvas.height/2;}

  updateHUD();

  // Render
  ctx.clearRect(0,0,canvas.width,canvas.height);
  // Player
  ctx.fillStyle="blue";
  ctx.beginPath();
  ctx.arc(canvas.width/2,canvas.height/2,player.r,0,Math.PI*2);
  ctx.fill();

  // Caixas
  boxes.forEach(box=>{
    let sx = canvas.width/2 + (box.x-player.x);
    let sy = canvas.height/2 + (box.y-player.y);
    ctx.fillStyle="brown";
    ctx.fillRect(sx-15,sy-15,30,30);
  });

  // Itens no ch√£o
  groundItems.forEach((gi,i)=>{
    let sx = canvas.width/2 + (gi.x-player.x);
    let sy = canvas.height/2 + (gi.y-player.y);
    ctx.fillText(gi.item,sx-10,sy+10);
  });

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
